def genalldots(txt): # https://mail.python.org/pipermail/python-list/2008-January/498838.html
   if len(txt)<=1:
     yield txt
   else:
     head, tail = txt[0], txt[1:]
     for item in genalldots(tail):
         yield head+item
         yield head+'.'+item
 
email    = raw_input('Email out @xxx.com: ').strip()
ending   = raw_input('Domain (Theres gmail.com and googlemail.com): ').strip()
per_time = int(raw_input('How many per time: ').strip())
emails   = sorted(genalldots(email))

print 'Emails available: ', len(emails)
 
done = 0
reqarr = []
 
try:
   import grequests, requests, re, sys
except:
   sys.exit('No gRequests, requests or re')
   
r = requests.get('https://collaboration.skype.com/promotion/', verify=False)
 
if(r.status_code != 200):
   sys.exit('Error')
 
token = re.search('csrfmiddlewaretoken\\\' value=\\\'(.*?)\\\'', r.content).group(1).strip() # Yolo the "security"
 
print 'Found token:', token
 
def hook(r):
   if r.status_code == 200:
       global done
       done += 1
       if(done % 10 == 0):
            print 'Done:', done
   else:
         sys.exit(r.content)
         
for email in emails:
   reqarr.append(grequests.post('https://collaboration.skype.com/promotion/', cookies = r.cookies, verify=False, hooks={'response': [hook]}, data={'email': email + '@' + ending, 'csrfmiddlewaretoken': token}, headers={'Referer': 'https://collaboration.skype.com/promotion/', 'User-Agent': 'Mozilla/5.0 (Windows NT 6.1; WOW64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/31.0.1650.63 Safari/537.36'}))
 
r = grequests.map(reqarr, size = per_time)[0]
 
print 'Done'

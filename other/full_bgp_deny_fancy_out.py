import requests, sys, time, bs4

last = ''
asn = '13335'

bgp = requests.get('http://bgp.he.net/AS' + asn, headers={'User-Agent':'Mozilla/5.0 So nice security on this place'})

if bgp.status_code != 200:
	sys.exit('he.net Error')

soup = bs4.BeautifulSoup(bgp.content)
op = soup.find(id='table_prefixes4')

title = soup.find('a', attrs={'rel': 'bookmark'}).text

print '######\n#', title, '\n######'

for p in op.find_all('tr'):
	ip = p.find('a')

	if not ip:
		continue

	desc = ip.parent.parent.div.parent.text.strip()

	if desc == last:
		desc = '^'
	else:
		last = desc

	print '    deny %s; # %s' % (ip.text, desc)
